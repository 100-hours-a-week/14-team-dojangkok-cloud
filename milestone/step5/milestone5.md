# Milestone5 : 수동 롤백 프로세스 정립 및 장애 알림 시스템 구축

## 1. 수동 롤백 프로세스

현재 도장콕 서비스는 자동화된 롤백 시스템 대신 **담당자에 의한 수동 롤백** 방식을 채택하고 있습니다. 이는 MVP 개발 단계의 특성과 인프라 환경을 고려한 전략적 의사결정으로, 그 구체적인 이유는 다음과 같습니다.

### 1) MVP 단계의 선택과 집중
초기 개발 단계에서는 한정된 리소스를 가장 효율적인 곳에 투입해야 합니다. 복잡한 자동 롤백 파이프라인을 구축하는 데 드는 엔지니어링 비용을 **기본적인 배포 환경 안정화**, **모니터링 환경 구축**, **데이터베이스 백업 전략 수립**에 투자하는 것이 서비스 안정성에 더 큰 기여를 한다고 판단했습니다.

### 2) 자동화의 잠재적 리스크 관리
명확한 롤백 정책이 정립되지 않은 상태에서의 섣부른 자동화는 오히려 서비스 가용성을 해칠 수 있다고 판단했습니다. 단순한 네트워크 지연이나 일시적인 외부 API 오류 등 애플리케이션 로직과 무관한 이슈로 인해 Health Check가 실패할 수 있습니다. 이때 자동 롤백이 트리거되면, 실제로는 정상 배포된 기능까지 불필요하게 취소되는 부작용이 발생할 수 있습니다. 장애 발생 시 **담당자가 로그와 메트릭을 기반으로 원인을 파악**한 후, 롤백 여부를 결정하는 방식을 유지하여 불필요한 배포 취소를 방지합니다.

### 3) 인프라 구조의 단순함과 CI/CD 활용성
현재 도장콕의 인프라는 단일 EC2 인스턴스와 빅뱅 배포 방식을 따르고 있어 구조가 매우 직관적입니다. 복잡한 마이크로서비스나 분산 환경이 아니므로, 문제 발생 시 이전 버전으로 되돌리는 과정이 단순합니다. 또한 별도의 복잡한 롤백 스크립트 없이도 기존 성공했던 **Workflow를 재실행**하는 것만으로 신속하고 안정적인 롤백이 가능합니다.

따라서 현 단계에서는 과도한 자동화 시스템 구축보다는, **담당자의 판단에 기반한 확실한 수동 롤백** 처리가 MVP 모델의 운영 효율성과 안정성에 더 부합한다고 판단하였습니다.

## 2. 수동 롤백 프로세스 절차

현재 도장콕은 별도의 롤백 스크립트나 빌드 파일 서버를 운영하지 않고, **Github Actions의 Workflow 재실행(Re-run)** 기능을 활용하여 효율적인 수동 롤백을 수행하고 있습니다. 구체적인 절차는 다음과 같습니다.

### 1) 롤백 대상 Workflow 식별
![수동롤백 1단계](https://raw.githubusercontent.com/100-hours-a-week/14-team-dojangkok-cloud/refs/heads/main/milestone/step5/images/manual_rollback_1.png)
- 도장콕은 **Main Branch Merge** 이벤트 발생 시 배포가 수행됩니다. 현재 배포된 버전에 장애가 감지되어 롤백이 결정된 상황을 가정합니다.
- Github Actions 탭의 Workflow 목록에서, **가장 최근에 성공적으로 배포되었던(Stable) 시점**의 Workflow를 식별하여 클릭합니다.

### 2) 재실행 범위 선정 (Artifacts 활용)
![수동롤백 2단계](https://raw.githubusercontent.com/100-hours-a-week/14-team-dojangkok-cloud/refs/heads/main/milestone/step5/images/manual_rollback_2.png)
- 도장콕은 빌드 산출물을 **Github Artifacts**로 관리하고 있어, 별도의 형상 관리 없이도 과거 빌드 파일에 접근할 수 있습니다. (Retention: 7일)
- **Artifacts 유효 기간(7일) 이내**: 이미 빌드된 파일이 존재하므로, 전체 과정을 수행할 필요 없이 **Deploy Job만 선택적으로 재실행**하여 신속하게 롤백합니다.
- **Artifacts 유효 기간 경과**: 빌드 파일이 만료되었으므로, **전체 Workflow를 재실행(Re-run all jobs)**하여 빌드부터 배포까지 새로 수행합니다.

### 3) Workflow 재실행 및 롤백 수행
![수동롤백 3단계](https://raw.githubusercontent.com/100-hours-a-week/14-team-dojangkok-cloud/refs/heads/main/milestone/step5/images/manual_rollback_3.png)
- **Re-run jobs** 버튼을 클릭하여 롤백을 시작합니다.
- 실행이 완료되면 해당 버전의 애플리케이션이 서버에 적용되어 서비스가 정상화됩니다.